doctype html
head
  meta(charset='UTF-8')
  meta(name='viewport' content='width=device-width, initial-scale=1.0')
  title Edit Furniture - MAYONDO WOOD &amp; FURNITURE
  style.
    * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: Arial, sans-serif;
    }
    body {
    background-color: #fff;
    color: #000;
    margin: 0 100px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    }
    .page-header {
    text-align: center;
    margin: 30px 0;
    }
    .page-header h1 {
    font-size: 28px;
    font-weight: bold;
    }
    .form-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 40px;
    }
    .form {
    width: 100%;
    max-width: 600px;
    padding: 30px;
    border: 1px solid #000;
    border-radius: 8px;
    }
    .image-preview {
    text-align: center;
    margin-bottom: 25px;
    }
    .image-preview img {
    max-width: 300px;
    height: auto;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    }
    .form-group {
    margin-bottom: 20px;
    }
    .form label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
    font-size: 14px;
    }
    .form input {
    width: 100%;
    padding: 12px;
    border: 1px solid #000;
    border-radius: 4px;
    font-size: 14px;
    }
    .form-actions {
    display: flex;
    gap: 15px;
    margin-top: 25px;
    }
    .btn {
    flex: 1;
    padding: 14px;
    border: none;
    border-radius: 4px;
    font-weight: bold;
    cursor: pointer;
    text-align: center;
    text-decoration: none;
    font-size: 16px;
    transition: all 0.3s ease;
    }
    .btn-primary {
    background-color: #000;
    color: #fff;
    }
    .btn-primary:hover {
    background-color: #333;
    }
    .btn-secondary {
    background-color: #fff;
    color: #000;
    border: 1px solid #000;
    }
    .btn-secondary:hover {
    background-color: #f5f5f5;
    }
    @media (max-width: 768px) {
    body {
    margin: 0 20px;
    }
    .form {
    padding: 20px;
    }
    .form-actions {
    flex-direction: column;
    }
    }

include ../components/nav

.page-header
  h1 Edit Furniture
  
.form-container
  .form
    if furniture.image
      .image-preview
        img#furnitureImage(src=furniture.image alt=furniture.name)
        
    form#editForm(data-furniture-id=furniture._id)
      .form-group
        label(for='name') Name
        input#name(type='text' name='name' value=furniture.name required='')
        
      .form-group
        label(for='productType') Product Type
        input#productType(type='text' name='productType' value=furniture.productType required='')
        
      .form-group
        label(for='quantity') Quantity
        input#quantity(type='number' name='quantity' value=furniture.quantity required='')
        
      .form-group
        label(for='costPrice') Cost Price (UGX)
        input#costPrice(type='number' name='costPrice' value=furniture.costPrice required='')
        
      .form-group
        label(for='productPrice') Product Price (UGX)
        input#productPrice(type='number' name='productPrice' value=furniture.productPrice required='')
        
      .form-group
        label(for='supplierName') Supplier Name
        input#supplierName(type='text' name='supplierName' value=furniture.supplierName required='')
        
      .form-group
        label(for='productQuality') Product Quality
        input#productQuality(type='text' name='productQuality' value=furniture.productQuality required='')
        
      .form-group
        label(for='color') Color (Optional)
        input#color(type='text' name='color' value=furniture.color || '')
        
      .form-group
        label(for='measurement') Measurement (Optional)
        input#measurement(type='text' name='measurement' value=furniture.measurement || '')
        
      .form-actions
        button.btn.btn-primary(type='submit') Update Furniture
        a.btn.btn-secondary(href='/displayfurniture') Cancel

include ../components/footer

script.
  document.getElementById('editForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const furnitureId = e.target.dataset.furnitureId;
    const formData = new FormData(e.target);
    const data = Object.fromEntries(formData);
    
    try {
      const response = await fetch(`/editfurniture/${furnitureId}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      });
      
      const result = await response.json();
      
      if (response.ok) {
        alert('Furniture updated successfully!');
        window.location.href = '/displayfurniture';
      } else {
        alert(result.message || 'Error updating furniture');
      }
    } catch (error) {
      console.error('Error:', error);
      alert('Error updating furniture');
    }
  });